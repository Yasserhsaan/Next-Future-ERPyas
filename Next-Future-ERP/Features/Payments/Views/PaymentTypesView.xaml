<Page
    x:Class="Next_Future_ERP.Features.Payments.Views.PaymentTypesView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="أنواع الدفع"
    FlowDirection="RightToLeft">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <!-- شريط الأزرار + بحث -->
        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
            <Button Content="جديد"   Width="110" Margin="5" Command="{Binding NewCommand}"/>
            <Button Content="حفظ"    Width="110" Margin="5" Command="{Binding SaveCommand}"/>
            <Button Content="حذف"    Width="110" Margin="5" Command="{Binding DeleteCommand}"/>
            <Button Content="تحديث"  Width="110" Margin="5" Command="{Binding LoadCommand}"/>

            <StackPanel Orientation="Horizontal" Margin="16,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="بحث:" Margin="0,0,6,0" VerticalAlignment="Center"/>
                <TextBox Width="220"
                         Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"/>
            </StackPanel>
        </StackPanel>

        <!-- إدخال -->
        <GroupBox Header="نوع دفع" Grid.Row="1" Margin="0,0,0,12">
            <Grid Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="160"/>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Margin="5">
                    <TextBlock Text="ID (Identity)" Margin="0,0,0,4"/>
                    <TextBox Text="{Binding Current.TypeId}" IsReadOnly="True"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Margin="5">
                    <TextBlock Text="Code (2 chars)" Margin="0,0,0,4"/>
                    <TextBox x:Name="txtCode"
                             MaxLength="2"
                             CharacterCasing="Upper"
                             TextChanged="TxtCode_TextChanged"
                             Text="{Binding Current.Code, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Margin="5">
                    <TextBlock Text="Description" Margin="0,0,0,4"/>
                    <TextBox MaxLength="50"
                             Text="{Binding Current.Description, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- الجدول -->
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding Items}"
                  SelectedItem="{Binding Current, Mode=TwoWay}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  SelectionMode="Single">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID"          Binding="{Binding TypeId}" Width="Auto"/>
                <DataGridTextColumn Header="Code"        Binding="{Binding Code}"   Width="200"/>
                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Page>
