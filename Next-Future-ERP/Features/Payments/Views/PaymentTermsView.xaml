<Page
    x:Class="Next_Future_ERP.Features.Payments.Views.PaymentTermsView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="شروط الدفع"
    FlowDirection="RightToLeft">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <!-- شريط الأزرار + بحث -->
        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
            <Button Content="جديد"   Width="110" Margin="5" Command="{Binding NewCommand}"/>
            <Button Content="حفظ"    Width="110" Margin="5" Command="{Binding SaveCommand}"/>
            <Button Content="حذف"    Width="110" Margin="5" Command="{Binding DeleteCommand}"/>
            <Button Content="تحديث"  Width="110" Margin="5" Command="{Binding LoadCommand}"/>

            <StackPanel Orientation="Horizontal" Margin="16,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="بحث:" Margin="0,0,6,0" VerticalAlignment="Center"/>
                <TextBox Width="220" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"/>
            </StackPanel>
        </StackPanel>

        <!-- إدخال -->
        <GroupBox Header="شرط دفع" Grid.Row="1" Margin="0,0,0,12">
            <Grid Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="220"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Column="0" Margin="5">
                    <TextBlock Text="الكود" Margin="0,0,0,4"/>
                    <TextBox Text="{Binding Current.TermCode, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Margin="5">
                    <TextBlock Text="الاسم" Margin="0,0,0,4"/>
                    <TextBox Text="{Binding Current.TermName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Margin="5">
                    <TextBlock Text="أيام الاستحقاق" Margin="0,0,0,4"/>
                    <TextBox x:Name="txtNetDays"
                             PreviewTextInput="OnlyDigits_PreviewTextInput"
                             DataObject.Pasting="OnlyDigits_Pasting"
                             Text="{Binding Current.NetDays, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <StackPanel Grid.Column="3" Margin="5">
                    <TextBlock Text="خصم %" Margin="0,0,0,4"/>
                    <TextBox x:Name="txtDiscPct"
                             PreviewTextInput="Decimal_PreviewTextInput"
                             DataObject.Pasting="Decimal_Pasting"
                             Text="{Binding Current.DiscountPercent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <StackPanel Grid.Column="0" Grid.Row="1" Margin="5">
                    <TextBlock Text="أيام الخصم" Margin="0,0,0,4"/>
                    <TextBox x:Name="txtDiscDays"
                             PreviewTextInput="OnlyDigits_PreviewTextInput"
                             DataObject.Pasting="OnlyDigits_Pasting"
                             Text="{Binding Current.DiscountDays, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Grid.Row="1" Margin="5">
                    <TextBlock Text="غرامة تأخير %" Margin="0,0,0,4"/>
                    <TextBox x:Name="txtLatePct"
                             PreviewTextInput="Decimal_PreviewTextInput"
                             DataObject.Pasting="Decimal_Pasting"
                             Text="{Binding Current.LateFeePercent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Grid.Row="1" Margin="5" Orientation="Horizontal" VerticalAlignment="Bottom">
                    <CheckBox Content="مفعل" IsChecked="{Binding Current.IsActive}"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- الجدول -->
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding Items}"
                  SelectedItem="{Binding Current, Mode=TwoWay}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  RowHeight="35"
                  FontSize="13">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID"      Binding="{Binding TermId}" Width="Auto"/>
                <DataGridTextColumn Header="الكود"    Binding="{Binding TermCode}" Width="*"/>
                <DataGridTextColumn Header="الاسم"    Binding="{Binding TermName}" Width="*"/>
                <DataGridTextColumn Header="الأيام"   Binding="{Binding NetDays}" Width="Auto"/>
                <DataGridTextColumn Header="خصم %"    Binding="{Binding DiscountPercent}" Width="Auto"/>
                <DataGridTextColumn Header="أيام خصم" Binding="{Binding DiscountDays}" Width="Auto"/>
                <DataGridTextColumn Header="غرامة %"  Binding="{Binding LateFeePercent}" Width="Auto"/>
                <DataGridCheckBoxColumn Header="مفعل" Binding="{Binding IsActive}" Width="Auto"/>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Page>
